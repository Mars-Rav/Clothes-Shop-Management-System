package View;

import java.io.EOFException;
import java.util.ArrayList;
import java.util.Scanner;
import Controllers.CashierController;
import Controllers.GarmentController;
import Controllers.InvoiceController;
import Controllers.Manager;
import Models.User;
import java.io.IOException;
import java.text.ParseException;

public class Main {
	
	static Scanner input = new Scanner(System.in);
	static User cashier;
	
	public static void main(String args[]) throws IOException, ParseException {
		
		boolean state = true;
		while(state) {
		switch(logIn()) {
		case 2:
			while(true) {
				System.out.println();
				System.out.println("------------------------------------------------");
				System.out.println();
				switch(displayCashierOptions()) {
				case 1:
					CashierController.addGarmentToInvoice(cashier);
					InvoiceController.printInvoice();
					break;
				case 2:
					GarmentController.printGarments();
					break;
				case 3:
					InvoiceController.printInvoices();
					break;
				case 4:
					System.exit(0);
					break;
					default:
						System.out.println("Please enter valid input.");
				}
			}
		case 1:
			
			state = false;
			System.out.println("------------------- Welcome -------------------");
			while(true) {
				System.out.println();
				System.out.println("------------------------------------------------");
				System.out.println();
				switch(displayManagerOptions()) {
				case 1:
					try {
						GarmentController.addToInventory();
					}catch (EOFException e) {
						// ... this is fine
					}break;

				case 2:
					GarmentController.printGarments();
					break;
				case 3:
					System.out.println("Search by:");
					System.out.println("1. Name");
					System.out.println("2. ID");
					int opt = Integer.parseInt(input.nextLine());
					
					switch(opt){
					case 1:
						System.out.println("Enter the name of the garment you want to search for:");
						String name = input.nextLine();
						
						System.out.println(Manager.searchGarment(name));
						break;
					case 2:
						System.out.println("Enter the ID of the garment you want to search for:");
						int id = Integer.parseInt(input.nextLine());
						
						System.out.println(Manager.searchGarment(id));
						break;
						default:
							System.out.println("Please enter valid input.");
					}
					
					break;
				case 4:
					CashierController.addToStaff();
					break;
				case 5:
					CashierController.printStaff();
					break;
				case 6:
					System.out.println("Search by:");
					System.out.println("1. Name");
					System.out.println("2. ID");
					int staffOpt = Integer.parseInt(input.nextLine());
					
					switch(staffOpt){
					case 1:
						System.out.println("Enter the name of the cashier you want to search for:");
						String name = input.nextLine();
						
						System.out.println(Manager.searchStaff(name));
						break;
					case 2:
						System.out.println("Enter the ID of the cashier you want to search for:");
						int id = Integer.parseInt(input.nextLine());
						
						System.out.println(Manager.searchStaff(id));
						break;
						default:
							System.out.println("Please enter valid input.");
					}
					
					break;
				case 7:
					System.exit(0);
					break;
				}
			}
		case 0:
			System.out.println("Please make sure you entered the right info.");
			break;
		default:
			System.out.println("Invalid input.");
		}
		}
		
	}
	
	public static int logIn()throws IOException, ParseException {
		System.out.println("Enter your username: [Manager: Mars] [Cashier: Srusht]");
		String username = input.nextLine();
		System.out.println("Enter your password: [Manager: 123abc] [Cashier: password123]");
		String password = input.nextLine();
		
		if(username.equals((String) Manager.getManagerInfo(1)) && password.equals((String) Manager.getPassword()))
			return 1;
		
		ArrayList<User> staff = CashierController.getStaff();
		for(int i = 0; i < staff.size(); i++) {
			if(staff.get(i).getName().equals(username) && staff.get(i).getPassword().equals(password))
				if(staff.get(i).getRole().equals("Cashier")) {
				cashier = staff.get(i);
				return 2;
				}else {
					System.out.println("You don't have access.");
				}
		}
		
		return 0;
	}
	
	public static int displayManagerOptions() {
		System.out.println("Enter the number of the function you want:");
		System.out.println("1. Add a new garment.");
		System.out.println("2. Display garments.");
		System.out.println("3. Search a garment.");
		System.out.println("4. Add a new cashier.");
		System.out.println("5. Display cashiers");
		System.out.println("6. Search a cashier.");
		System.out.println("7. Exit.");
		
		return Integer.parseInt(input.nextLine());
	}
	
	public static int displayCashierOptions() {
		System.out.println("Enter the number of the function you want:");
		System.out.println("1. Create a new invoice.");
		System.out.println("2. Display garments");
		System.out.println("3. Show history.");
		System.out.println("4. Exit.");
		
		return Integer.parseInt(input.nextLine());
	}
	
}
